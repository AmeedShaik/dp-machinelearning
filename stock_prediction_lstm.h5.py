# -*- coding: utf-8 -*-
"""stock_prediction_lstm.h5

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1hD1yO6LQbBKRmd-C3wc2qpbNuWQ75Dy4
"""

import yfinance as yf
import pandas as pd

# Download stock data
ticker = "YESBANK.NS"  # Replace with desired stock ticker
df = yf.download(ticker, start="2015-01-01", end="2024-01-01")
df = df[['Close']]  # We'll use the 'Close' price for prediction
df.head()

from sklearn.preprocessing import MinMaxScaler

scaler = MinMaxScaler(feature_range=(0, 1))
scaled_data = scaler.fit_transform(df)

# Visualize normalized data
import matplotlib.pyplot as plt
plt.plot(scaled_data)
plt.title("Normalized Stock Price")
plt.show()



import numpy as np

def create_sequences(data, time_step=60):
    X, y = [], []
    for i in range(len(data) - time_step):
        X.append(data[i:i+time_step, 0])
        y.append(data[i+time_step, 0])
    return np.array(X), np.array(y)

time_step = 60
X, y = create_sequences(scaled_data, time_step)
